<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>CoherenceDomainDataRegionImpl.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Coherence Hibernate Website</a> &gt; <a href="../index.html" class="el_bundle">coherence-hibernate-cache-53</a> &gt; <a href="index.source.html" class="el_package">com.oracle.coherence.hibernate.cache.v53.access</a> &gt; <span class="el_source">CoherenceDomainDataRegionImpl.java</span></div><h1>CoherenceDomainDataRegionImpl.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2013, 2023, Oracle and/or its affiliates.
 *
 * Licensed under the Universal Permissive License v 1.0 as shown at
 * https://oss.oracle.com/licenses/upl.
 */
package com.oracle.coherence.hibernate.cache.v53.access;

import java.util.Comparator;

import org.hibernate.cache.CacheException;
import org.hibernate.cache.cfg.spi.CollectionDataCachingConfig;
import org.hibernate.cache.cfg.spi.DomainDataRegionBuildingContext;
import org.hibernate.cache.cfg.spi.DomainDataRegionConfig;
import org.hibernate.cache.cfg.spi.EntityDataCachingConfig;
import org.hibernate.cache.cfg.spi.NaturalIdDataCachingConfig;
import org.hibernate.cache.spi.CacheKeysFactory;
import org.hibernate.cache.spi.access.CollectionDataAccess;
import org.hibernate.cache.spi.access.EntityDataAccess;
import org.hibernate.cache.spi.access.NaturalIdDataAccess;
import org.hibernate.cache.spi.support.DomainDataRegionImpl;
import org.hibernate.cache.spi.support.DomainDataStorageAccess;
import org.hibernate.cache.spi.support.RegionFactoryTemplate;

/**
 * Coherence-specific extension of the {@link org.hibernate.cache.spi.support.DomainDataRegionTemplate}.
 * @author Gunnar Hillert
 * @since 2.1
 */
public class CoherenceDomainDataRegionImpl extends DomainDataRegionImpl {

    public CoherenceDomainDataRegionImpl(DomainDataRegionConfig regionConfig, RegionFactoryTemplate regionFactory,
            DomainDataStorageAccess domainDataStorageAccess, CacheKeysFactory defaultKeysFactory,
            DomainDataRegionBuildingContext buildingContext) {
<span class="nc" id="L35">        super(regionConfig, regionFactory, domainDataStorageAccess, defaultKeysFactory, buildingContext);</span>
<span class="nc" id="L36">    }</span>

    @Override
    protected EntityDataAccess generateTransactionalEntityDataAccess(EntityDataCachingConfig entityAccessConfig) {
<span class="nc" id="L40">        throw new CacheException(AbstractCoherenceEntityDataAccess.TRANSACTIONAL_STRATEGY_NOT_SUPPORTED_MESSAGE);</span>
    }

    @Override
    protected NaturalIdDataAccess generateTransactionalNaturalIdDataAccess(NaturalIdDataCachingConfig accessConfig) {
<span class="nc" id="L45">        throw new CacheException(AbstractCoherenceEntityDataAccess.TRANSACTIONAL_STRATEGY_NOT_SUPPORTED_MESSAGE);</span>
    }

    @Override
    protected CollectionDataAccess generateTransactionalCollectionDataAccess(CollectionDataCachingConfig accessConfig) {
<span class="nc" id="L50">        throw new CacheException(AbstractCoherenceEntityDataAccess.TRANSACTIONAL_STRATEGY_NOT_SUPPORTED_MESSAGE);</span>
    }

    @Override
    protected EntityDataAccess generateReadOnlyEntityAccess(EntityDataCachingConfig accessConfig) {
<span class="nc bnc" id="L55" title="All 2 branches missed.">        final Comparator&lt;?&gt; versionComparator = (accessConfig.getVersionComparatorAccess() != null)</span>
<span class="nc" id="L56">                ? accessConfig.getVersionComparatorAccess().get() : null;</span>

<span class="nc" id="L58">        return new CoherenceReadOnlyEntityAccess(this, this.getCacheStorageAccess(), versionComparator);</span>
    }

    @Override
    protected EntityDataAccess generateReadWriteEntityAccess(EntityDataCachingConfig accessConfig) {
<span class="nc bnc" id="L63" title="All 2 branches missed.">        final Comparator&lt;?&gt; versionComparator = (accessConfig.getVersionComparatorAccess() != null)</span>
<span class="nc" id="L64">                ? accessConfig.getVersionComparatorAccess().get() : null;</span>

<span class="nc" id="L66">        return new CoherenceReadWriteEntityAccess(this, this.getCacheStorageAccess(), versionComparator);</span>
    }

    @Override
    protected EntityDataAccess generateNonStrictReadWriteEntityAccess(EntityDataCachingConfig accessConfig) {
<span class="nc bnc" id="L71" title="All 2 branches missed.">        final Comparator&lt;?&gt; versionComparator = (accessConfig.getVersionComparatorAccess() != null)</span>
<span class="nc" id="L72">                ? accessConfig.getVersionComparatorAccess().get() : null;</span>

<span class="nc" id="L74">        return new CoherenceNonstrictReadWriteEntityAccess(this, getCacheStorageAccess(), versionComparator);</span>
    }

    // ---- Natural Id Access

    @Override
    protected NaturalIdDataAccess generateReadOnlyNaturalIdAccess(NaturalIdDataCachingConfig accessConfig) {
<span class="nc" id="L81">        return new CoherenceReadOnlyNaturalIdAccess(this, getCacheStorageAccess());</span>
    }

    @Override
    protected NaturalIdDataAccess generateReadWriteNaturalIdAccess(NaturalIdDataCachingConfig accessConfig) {
<span class="nc" id="L86">        return new CoherenceReadWriteNaturalIdAccess(this, getCacheStorageAccess());</span>
    }

    @Override
    protected NaturalIdDataAccess generateNonStrictReadWriteNaturalIdAccess(NaturalIdDataCachingConfig accessConfig) {
<span class="nc" id="L91">        return new CoherenceNonstrictReadWriteNaturalIdAccess(this, getCacheStorageAccess());</span>
    }

    @Override
    public CollectionDataAccess generateCollectionAccess(CollectionDataCachingConfig accessConfig) {
<span class="nc bnc" id="L96" title="All 2 branches missed.">        final Comparator&lt;?&gt; versionComparator = (accessConfig.getOwnerVersionComparator() != null)</span>
<span class="nc" id="L97">                ? accessConfig.getOwnerVersionComparator() : null;</span>

<span class="nc bnc" id="L99" title="All 5 branches missed.">        switch (accessConfig.getAccessType()) {</span>
            case READ_ONLY:
<span class="nc" id="L101">                return new CoherenceReadOnlyCollectionAccess(this, getCacheStorageAccess(), versionComparator);</span>
            case READ_WRITE:
<span class="nc" id="L103">                return new CoherenceReadWriteCollectionAccess(this, getCacheStorageAccess(), versionComparator);</span>
            case NONSTRICT_READ_WRITE:
<span class="nc" id="L105">                return new CoherenceNonstrictReadWriteCollectionAccess(this, getCacheStorageAccess(), versionComparator);</span>
            case TRANSACTIONAL:
<span class="nc" id="L107">                return generateTransactionalCollectionDataAccess(accessConfig);</span>
            default:
<span class="nc" id="L109">                throw new IllegalArgumentException(&quot;Unrecognized cache AccessType - &quot; + accessConfig.getAccessType());</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>